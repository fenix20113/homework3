/* jQuery Captify Plugin
 *
 * Copyright (C) 2008 Brian Reavis
 * Licenced under the MIT license
 *
 * jQueryDate: 2008-2-27 [Fri, 27 Feb 2009] jQuery
 */jQuery.fn.extend({captify:function(e){var e=jQuery.extend({speedOver:"fast",speedOut:"normal",hideDelay:500,animation:"slide",prefix:"",opacity:"0.35",className:"caption-bottom",position:"bottom",spanWidth:"100%"},e);jQuery(this).each(function(){var t=this;jQuerythis=t;if(this.hasInit)return!1;this.hasInit=!0;var n=!1,r=!1,i=jQuery("#"+jQuery(this).attr("rel")),s=i.length?i.html():jQuery(this).attr("alt");i.remove();var u=this.parent&&this.parent.tagName=="a"?this.parent:jQuery(this),a=u.wrap("<div></div>").parent();a.css({overflow:"hidden",padding:0,fontSize:.1});a.addClass("caption-wrapper");a.width(jQuery(this).width());a.height(jQuery(this).height());a.click(function(){window.location=jQuery(this).parent().attr("href")});jQuery.map(["top","right","bottom","left"],function(e){a.css("margin-"+e,jQuery(t).css("margin-"+e));jQuery.map(["style","width","color"],function(n){var r="border-"+e+"-"+n;a.css(r,jQuery(t).css(r))})});jQuery(t).css({border:"0 none"});var f=jQuery("div:last",a.append("<div></div>")).addClass(e.className),l=jQuery("div:last",a.append("<div></div>")).addClass(e.className).append(e.prefix).append(s);jQuery("*",a).css({margin:0}).show();var c=jQuery.browser.msie?"static":"relative";jQuery.browser.msie&&jQuery.browser.version.substr(0,1)>8&&(c="relative");f.css({zIndex:1,position:c,opacity:e.animation=="fade"?0:e.opacity,width:e.spanWidth});if(e.position=="bottom"){var h=parseInt(f.css("border-top-width").replace("px",""))+parseInt(l.css("padding-top").replace("px",""))-1;l.css("paddingTop",h)}l.css({position:c,zIndex:2,background:"none",border:"0 none",opacity:e.animation=="fade"?0:1,width:e.spanWidth});f.width(l.outerWidth());f.height(l.height());var p=e.position=="bottom"&&jQuery.browser.msie?-4:0,d=e.position=="top"?{hide:-jQuery(t).height()-f.outerHeight()-1,show:-jQuery(t).height()}:{hide:0,show:-f.outerHeight()+p};l.css("marginTop",-f.outerHeight());f.css("marginTop",d[e.animation=="fade"||e.animation=="always-on"?"show":"hide"]);var v=function(){if(!l.data("animating_out")){l.data("animating_out",!0);if(!n&&!r){var t=e.animation=="fade"?{opacity:0}:{marginTop:d.hide};f.animate(t,e.speedOut,function(){l.data("animating_out",!1)});e.animation=="fade"&&l.animate({opacity:0},e.speedOver,function(){l.data("animating_out",!1)})}else l.data("animating_out",!1)}};if(e.animation!="always-on"){jQuery(this).hover(function(){if(!l.data("animating_in")){l.data("animating_in",!0);r=!0;if(!n){var t=e.animation=="fade"?{opacity:e.opacity}:{marginTop:d.show};f.animate(t,e.speedOver,function(){l.data("animating_in",!1)});e.animation=="fade"&&l.animate({opacity:1},e.speedOver/2,function(){l.data("animating_in",!1)})}else l.data("animating_in",!1)}},function(){r=!1;window.setTimeout(v,e.hideDelay)});jQuery("div",a).hover(function(){n=!0},function(){n=!1;window.setTimeout(v,e.hideDelay)})}this.complete||this.naturalWidth>0})}});